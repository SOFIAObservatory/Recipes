<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HAWC+ Data Inspection &mdash; SOFIA cookbooks  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="EXES" href="exes.html" />
    <link rel="prev" title="HAWC+" href="hawc%2B.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> SOFIA cookbooks
            <img src="_static/sofia_dark_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Quick Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://www.sofia.usra.edu/data/data-analysis">SOFIA Data Analysis</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/SOFIAObservatory/Recipes">Cookbook Github Repository</a></li>
<li class="toctree-l1"><a class="reference external" href="https://irsa.ipac.caltech.edu/Missions/sofia.html">Data Archive</a></li>
<li class="toctree-l1"><a class="reference external" href="https://sofia-faqs.readthedocs.io/en/latest/">FAQs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Recipes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="general.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="forcast.html">FORCAST</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="hawc%2B.html">HAWC+</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">HAWC+ Data Inspection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Goals">Goals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Imports">Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Ingredients">Ingredients</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#You-can-download-the-example-data-directly-here.">You can download the example data directly here.</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#SOFIA-Data-Organization">SOFIA Data Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#30-Dor-data">30 Dor data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Data-Structure">Data Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Stokes-I">Stokes I</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Stokes-Q-and-U">Stokes Q and U</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Polarized-Intensity-Ip">Polarized Intensity Ip</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plotting-Polarization-Vectors">Plotting Polarization Vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plotting-Polarization-Fraction">Plotting Polarization Fraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#HAWC+-Polarization-Maps">HAWC+ Polarization Maps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="exes.html">EXES</a></li>
<li class="toctree-l1"><a class="reference internal" href="great.html">GREAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="fifi-ls.html">FIFI-LS</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SOFIA cookbooks</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="hawc%2B.html">HAWC+</a> &raquo;</li>
      <li>HAWC+ Data Inspection</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/HAWC_30Dor.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="HAWC+-Data-Inspection">
<h1>HAWC+ Data Inspection<a class="headerlink" href="#HAWC+-Data-Inspection" title="Permalink to this headline"></a></h1>
<ul class="simple">
<li><p><strong>Aim</strong>: Basic inspection and analysis.</p></li>
<li><p><strong>Data</strong>: Level 4 imaging polarimetry data for 30 Dor</p></li>
<li><p><strong>Tools</strong>: astropy</p></li>
<li><p><strong>Instrument</strong>: HAWC+</p></li>
<li><p><strong>Documentation</strong>: <a class="reference external" href="https://www.sofia.usra.edu/sites/default/files/Instruments/HAWC_PLUS/Documents/hawc_data_handbook.pdf">HAWC+ Data Handbook</a>.</p></li>
<li><p><strong>Notebook repository</strong>: <a class="reference external" href="https://github.com/SOFIAObservatory/Recipes">https://github.com/SOFIAObservatory/Recipes</a></p></li>
</ul>
<section id="Goals">
<h2>Goals<a class="headerlink" href="#Goals" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Load and plot stokes I, Q and U data</p></li>
<li><p>Create polarized intensity and polization fraction maps</p></li>
<li><p>Overplot polization vectors</p></li>
<li><p>Create all polization maps</p></li>
</ul>
</section>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline"></a></h2>
<p>This recipe provides an overview and sample python code for inspecting and plotting HAWC+ data. The data used in this example come from a SOFIA press release (<a class="reference external" href="https://www.sofia.usra.edu/multimedia/science-results-archive/sofia-reveals-never-seen-magnetic-field-details">SOFIA Reveals Never-Before-Seen Magnetic Field Details</a>) and the data are publicly available. We will go through the inital steps for loading the level 4 polarization and creating polarization maps.</p>
</section>
<section id="Imports">
<h2>Imports<a class="headerlink" href="#Imports" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">aplpy</span> <span class="kn">import</span> <span class="n">FITSFigure</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</section>
<section id="Ingredients">
<h2>Ingredients<a class="headerlink" href="#Ingredients" title="Permalink to this headline"></a></h2>
<p>Downloading HAWC+ Data</p>
<ul class="simple">
<li><p>Fill in the following fields</p></li>
<li><p>Spatial constraints:</p>
<ul>
<li><p>Coordinates or object name: <code class="docutils literal notranslate"><span class="pre">30</span> <span class="pre">Dor</span></code> from drop-down menu</p></li>
<li><p>Radius: <code class="docutils literal notranslate"><span class="pre">600</span> <span class="pre">arcseconds</span></code></p></li>
</ul>
</li>
<li><p>Click on the arrow next to Observation Constraints to open the drop-down options.</p></li>
<li><p>Observation Constraints:</p>
<ul>
<li><p>Observation Date: From: <code class="docutils literal notranslate"><span class="pre">2018-01-01</span></code> To: <code class="docutils literal notranslate"><span class="pre">2019-01-01</span></code></p></li>
</ul>
</li>
<li><p>Instrument Constraints</p>
<ul>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">HAWC+</span></code></p></li>
</ul>
</li>
<li><p>Data Product Constraints:</p>
<ul>
<li><p>Processing Level: <code class="docutils literal notranslate"><span class="pre">Level</span> <span class="pre">4</span></code></p></li>
<li><p>Click the <code class="docutils literal notranslate"><span class="pre">Search</span></code> button</p></li>
</ul>
</li>
<li><p>After the results load, select the checkboxes next to the Column header AOR ID to select all data files. All files should now have a blue check indicating selection.</p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Prepare</span> <span class="pre">Download</span></code></p></li>
<li><p>Fill in Title as <code class="docutils literal notranslate"><span class="pre">HAWC+_example_data</span></code></p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Prepare</span> <span class="pre">Download</span></code></p></li>
<li><p>After a few minutes, the data will be downloaded locally.</p></li>
<li><p>For more information, consult the <a class="reference external" href="https://www.sofia.usra.edu/sites/default/files/Instruments/HAWC_PLUS/Documents/hawc_data_handbook.pdf">HAWC+ Data Handbook</a>.</p></li>
</ul>
<section id="You-can-download-the-example-data-directly-here.">
<h3>You can download the example data directly <a class="reference external" href="https://zenodo.org/record/5706312/files/hawc-sample-data.zip?download=1">here</a>.<a class="headerlink" href="#You-can-download-the-example-data-directly-here." title="Permalink to this headline"></a></h3>
</section>
</section>
<section id="SOFIA-Data-Organization">
<h2>SOFIA Data Organization<a class="headerlink" href="#SOFIA-Data-Organization" title="Permalink to this headline"></a></h2>
<p>After downloading the SOFIA data to your working directory you will want to unzip it, which will produce a directory structure like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">.</span>
<span class="go">└── HAWC+_example_data</span>
<span class="go">    ├── level4</span>
<span class="go">    │   └── p5813</span>
<span class="go">    │       └── F0484_HA_POL_7600018_HAWCHWPC_PMP_022-114.fits</span>
<span class="go">    └── missions</span>
<span class="go">        ├── 2018-07-05_HA_F481</span>
<span class="go">        │   └── p5827</span>
<span class="go">        │       └── F0481_HA_POL_7600012_HAWDHWPD_PMP_050-083.fits</span>
<span class="go">        ├── 2018-07-07_HA_F483</span>
<span class="go">        │   └── p5646</span>
<span class="go">        │       └── F0483_HA_POL_7600014_HAWCHWPC_PMP_022-065.fits</span>
<span class="go">        ├── 2018-07-11_HA_F484</span>
<span class="go">        │   └── p5648</span>
<span class="go">        │       └── F0484_HA_POL_7600017_HAWCHWPC_PMP_065-114.fits</span>
<span class="go">        └── 2018-07-12_HA_F485</span>
<span class="go">            └── p5658</span>
<span class="go">                ├── g1</span>
<span class="go">                │   └── F0485_HA_POL_76000110_HAWAHWPA_PMP_043-052.fits</span>
<span class="go">                └── g2</span>
<span class="go">                    └── F0485_HA_POL_7600019_HAWEHWPE_PMP_055-075.fits</span>
</pre></div>
</div>
<p>Note the following features of this data bundle.</p>
<ul class="simple">
<li><p>Each <code class="docutils literal notranslate"><span class="pre">fits</span></code> file in the ‘missions’ directory corresponds to data from a single AOR (or a different filter element) obtained on a single flight</p></li>
<li><p>Each subdirectory under missions corresponds to a single flight</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fits</span></code> files under ‘level4’ correspond to data combined from several flights</p></li>
<li><p>If multiple filters were observed on the same flight, they will be further divided into subdirectories (g1/g2 on the last line)</p></li>
</ul>
<p>Note that two observations were made with the same filter (HAWC C, <span class="math notranslate nohighlight">\(89\,\mathrm{\mu m}\)</span>). These files, <code class="docutils literal notranslate"><span class="pre">F0483_HA_POL_7600014_HAWCHWPC_PMP_022-065.fits</span></code> and <code class="docutils literal notranslate"><span class="pre">F0484_HA_POL_7600017_HAWCHWPC_PMP_065-114.fits</span></code>, were combined into one:</p>
<p><code class="docutils literal notranslate"><span class="pre">level4-&gt;p5813-&gt;F0484_HA_POL_7600018_HAWCHWPC_PMP_022-114.fits</span></code>.</p>
<p>You can choose to keep the <code class="docutils literal notranslate"><span class="pre">fits</span></code> files nested, or copy them into one directory.</p>
<p>For the purpose of this basic analysis, though, let us dump all the files into one <code class="docutils literal notranslate"><span class="pre">sofia_data</span></code> directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">.</span>
<span class="go">└── sofia_data</span>
<span class="go">    ├── F0481_HA_POL_7600012_HAWDHWPD_PMP_050-083.fits</span>
<span class="go">    ├── F0483_HA_POL_7600014_HAWCHWPC_PMP_022-065.fits</span>
<span class="go">    ├── F0484_HA_POL_7600017_HAWCHWPC_PMP_065-114.fits</span>
<span class="go">    ├── F0484_HA_POL_7600018_HAWCHWPC_PMP_022-114.fits</span>
<span class="go">    ├── F0485_HA_POL_76000110_HAWAHWPA_PMP_043-052.fits</span>
<span class="go">    └── F0485_HA_POL_7600019_HAWEHWPE_PMP_055-075.fits</span>
</pre></div>
</div>
</section>
<section id="30-Dor-data">
<h2>30 Dor data<a class="headerlink" href="#30-Dor-data" title="Permalink to this headline"></a></h2>
<p>The Strategic Director’s Discretionary Time (S-DDT) for SOFIA is aimed at providing the astronomical community with data sets of high scientific interest over a broadrange of potential research topics without any proprietary period. These observingsessions allow the general user community access to high-level data products that aremeant not only for general understanding of SOFIA data and its packaging but also for inclusion in published scientific work. The S-DDT target have been selected on a
non-interference basis with existing programs and in terms of SOFIA flight planning.</p>
<p>The 76_0001 program, “Community Science: HAWC+ Polarimetry of 30 Dor,” was designed and scheduled to provide the community with SOFIA polarimetry data of an important and relatively bright source. The observing strategy also provided significantly increased scheduling efficiency for the OC6I (HAWC+) flights in July 2018. The west-bound observing legs for 30 Doradus allowed a larger fraction of the highest ranked Cycle 6 targets, predominantly in the inner Galaxy, to be scheduled and flown.</p>
<p>This cookbook recipe follows the SOFIA press release of 30 Doradus observations: <a class="reference external" href="https://www.sofia.usra.edu/multimedia/science-results-archive/sofia-reveals-never-seen-magnetic-field-details">SOFIA Reveals Never-Before-Seen Magnetic Field Details</a>. The Level 4 reduced data from this program has been released immediately to the public and is available on the Infrared Science Archive <a class="reference external" href="https://irsa.ipac.caltech.edu/Missions/sofia.html">(IRSA)</a>.</p>
<p>To enhance the scientific exploitation of these data products, we present here an overview of the observations, visualizations of the data, and preliminary analysis of their quality.</p>
</section>
<section id="Data-Structure">
<h2>Data Structure<a class="headerlink" href="#Data-Structure" title="Permalink to this headline"></a></h2>
<p>For this analysis, we require the standard <a class="reference external" href="https://scipy.org/install.html">numpy/scipy/matplotlib stack</a> as well the <a class="reference external" href="http://docs.astropy.org/en/stable/">astropy</a> and <a class="reference external" href="https://aplpy.readthedocs.io/en/stable/index.html">aplpy</a> modules.</p>
<p>With just a few lines of code, we can explore the HAWC+ <code class="docutils literal notranslate"><span class="pre">fits</span></code> data cubes and plot the images.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;example_data/HAWC/&#39;</span>
<span class="n">efile</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s1">&#39;F0485_HA_POL_7600019_HAWEHWPE_PMP_055-075.fits&#39;</span>
<span class="n">dfile</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s1">&#39;F0481_HA_POL_7600012_HAWDHWPD_PMP_050-083.fits&#39;</span>
<span class="n">cfile</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s1">&#39;F0484_HA_POL_7600018_HAWCHWPC_PMP_022-114.fits&#39;</span>

<span class="n">afile</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s1">&#39;F0485_HA_POL_76000110_HAWAHWPA_PMP_043-052.fits&#39;</span>
<span class="n">hawc</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">afile</span><span class="p">)</span>
<span class="n">hawc</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Filename: example_data/HAWC/F0485_HA_POL_76000110_HAWAHWPA_PMP_043-052.fits
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  STOKES I      1 PrimaryHDU     572   (94, 114)   float64
  1  ERROR I       1 ImageHDU        27   (94, 114)   float64
  2  STOKES Q      1 ImageHDU        18   (94, 114)   float64
  3  ERROR Q       1 ImageHDU        18   (94, 114)   float64
  4  STOKES U      1 ImageHDU        18   (94, 114)   float64
  5  ERROR U       1 ImageHDU        18   (94, 114)   float64
  6  IMAGE MASK    1 ImageHDU        27   (94, 114)   float64
  7  PERCENT POL    1 ImageHDU        18   (94, 114)   float64
  8  DEBIASED PERCENT POL    1 ImageHDU        18   (94, 114)   float64
  9  ERROR PERCENT POL    1 ImageHDU        18   (94, 114)   float64
 10  POL ANGLE     1 ImageHDU        18   (94, 114)   float64
 11  ROTATED POL ANGLE    1 ImageHDU        18   (94, 114)   float64
 12  ERROR POL ANGLE    1 ImageHDU        18   (94, 114)   float64
 13  POL FLUX      1 ImageHDU        18   (94, 114)   float64
 14  ERROR POL FLUX    1 ImageHDU        18   (94, 114)   float64
 15  DEBIASED POL FLUX    1 ImageHDU        18   (94, 114)   float64
 16  MERGED DATA    1 BinTableHDU    234   8R x 67C   [1J, 1E, 1E, 1E, 1E, 1E, 1E, 1E, 1E, 1J, 1J, 1E, 1K, 1K, 1J, 1E, 1E, 1J, 1E, 1E, 1E, 1E, 1E, 1E, 1B, 1E, 1E, 1E, 1E, 1E, 1E, 1D, 1D, 1D, 1D, 1D, 1D, 1D, 1D, 1D, 1D, 1D, 1D, 1D, 1D, 1D, 1J, 1D, 1J, 1D, 1D, 1D, 1J, 1J, 1J, 2624E, 2624E, 1E, 1J, 2624E, 2624E, 2624E, 2624E, D, D, D, 49A]
 17  POL DATA      1 BinTableHDU     34   10716R x 10C   [J, J, D, D, D, D, D, D, D, D]
 18  FINAL POL DATA    1 BinTableHDU     30   84R x 8C   [D, D, D, D, D, D, D, D]
</pre></div></div>
</div>
<p>We can see above the data structure of the multi-extension <code class="docutils literal notranslate"><span class="pre">fits</span></code> files. Each file contains 19 extensions which encapsulates all of the measurable Stokes parameters, derived polarization information, and associated errors in a single package.</p>
<hr></section>
<section id="Stokes-I">
<h2>Stokes I<a class="headerlink" href="#Stokes-I" title="Permalink to this headline"></a></h2>
<p>Stokes <span class="math notranslate nohighlight">\(I\)</span>—the zeroth extension in the <code class="docutils literal notranslate"><span class="pre">fits</span></code> file—represents the total intensity of the image.</p>
<p>Let us go ahead and plot this extension:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set colormap for all plots</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;rainbow&#39;</span>

<span class="n">stokes_i</span> <span class="o">=</span> <span class="n">hawc</span><span class="p">[</span><span class="s1">&#39;STOKES I&#39;</span><span class="p">]</span>               <span class="c1"># or hawc[0]. Note the extension is from the hawc.info() table above</span>

<span class="n">axs</span> <span class="o">=</span> <span class="n">FITSFigure</span><span class="p">(</span><span class="n">stokes_i</span><span class="p">)</span>                <span class="c1"># load HDU into aplpy figure</span>
<span class="n">axs</span><span class="o">.</span><span class="n">show_colorscale</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>            <span class="c1"># display the data with WCS projection and chosen colormap</span>

<span class="c1"># FORMATTING</span>
<span class="n">axs</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>

<span class="c1"># Add colorbar</span>
<span class="n">axs</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">()</span>
<span class="n">axs</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">set_axis_label_text</span><span class="p">(</span><span class="s1">&#39;Flux (Jy/pix)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INFO: Auto-setting vmin to -9.881e-02 [aplpy.core]
INFO: Auto-setting vmax to  1.747e+00 [aplpy.core]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/HAWC_30Dor_17_1.png" src="_images/HAWC_30Dor_17_1.png" />
</div>
</div>
</section>
<section id="Stokes-Q-and-U">
<h2>Stokes Q and U<a class="headerlink" href="#Stokes-Q-and-U" title="Permalink to this headline"></a></h2>
<p>Similarly, we can plot the Stokes Q and Stokes U images:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stokes_q</span> <span class="o">=</span> <span class="n">hawc</span><span class="p">[</span><span class="s1">&#39;STOKES Q&#39;</span><span class="p">]</span>
<span class="n">stokes_u</span> <span class="o">=</span> <span class="n">hawc</span><span class="p">[</span><span class="s1">&#39;STOKES U&#39;</span><span class="p">]</span>

<span class="n">axq</span> <span class="o">=</span> <span class="n">FITSFigure</span><span class="p">(</span><span class="n">stokes_q</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># generate FITSFigure as subplot to have two axes together</span>
<span class="n">axq</span><span class="o">.</span><span class="n">show_colorscale</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>               <span class="c1"># show Q</span>


<span class="n">axu</span> <span class="o">=</span> <span class="n">FITSFigure</span><span class="p">(</span><span class="n">stokes_u</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                 <span class="n">figure</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
<span class="n">axu</span><span class="o">.</span><span class="n">show_colorscale</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>               <span class="c1"># show U</span>

<span class="c1"># FORMATTING</span>
<span class="n">axq</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Stokes Q&#39;</span><span class="p">)</span>
<span class="n">axu</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Stokes U&#39;</span><span class="p">)</span>
<span class="n">axu</span><span class="o">.</span><span class="n">axis_labels</span><span class="o">.</span><span class="n">set_yposition</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">axu</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">set_yposition</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">axq</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="n">axq</span><span class="o">.</span><span class="n">axis_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="n">axu</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="n">axu</span><span class="o">.</span><span class="n">axis_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INFO: Auto-setting vmin to -7.192e-02 [aplpy.core]
INFO: Auto-setting vmax to  9.014e-02 [aplpy.core]
INFO: Auto-setting vmin to -6.312e-02 [aplpy.core]
INFO: Auto-setting vmax to  8.091e-02 [aplpy.core]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/HAWC_30Dor_19_1.png" src="_images/HAWC_30Dor_19_1.png" />
</div>
</div>
<hr><p>We can additionally plot the associated error maps for each extension.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stokes_q</span> <span class="o">=</span> <span class="n">hawc</span><span class="p">[</span><span class="s1">&#39;STOKES Q&#39;</span><span class="p">]</span>
<span class="n">error_q</span> <span class="o">=</span> <span class="n">hawc</span><span class="p">[</span><span class="s1">&#39;ERROR Q&#39;</span><span class="p">]</span>

<span class="n">axq</span> <span class="o">=</span> <span class="n">FITSFigure</span><span class="p">(</span><span class="n">stokes_q</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># generate FITSFigure as subplot to have two axes together</span>
<span class="n">axq</span><span class="o">.</span><span class="n">show_colorscale</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>               <span class="c1"># show Q</span>


<span class="n">axe</span> <span class="o">=</span> <span class="n">FITSFigure</span><span class="p">(</span><span class="n">error_q</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">figure</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
<span class="n">axe</span><span class="o">.</span><span class="n">show_colorscale</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>               <span class="c1"># show error</span>

<span class="c1"># FORMATTING</span>
<span class="n">axq</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Stokes Q&#39;</span><span class="p">)</span>
<span class="n">axe</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Error Q&#39;</span><span class="p">)</span>
<span class="n">axq</span><span class="o">.</span><span class="n">axis_labels</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>                       <span class="c1"># hide axis/tick labels</span>
<span class="n">axe</span><span class="o">.</span><span class="n">axis_labels</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
<span class="n">axq</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
<span class="n">axe</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">hide</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INFO: Auto-setting vmin to -7.005e-02 [aplpy.core]
INFO: Auto-setting vmax to  8.979e-02 [aplpy.core]
INFO: Auto-setting vmin to  3.753e-03 [aplpy.core]
INFO: Auto-setting vmax to  3.286e-02 [aplpy.core]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/HAWC_30Dor_21_1.png" src="_images/HAWC_30Dor_21_1.png" />
</div>
</div>
</section>
<section id="Polarized-Intensity-Ip">
<h2>Polarized Intensity Ip<a class="headerlink" href="#Polarized-Intensity-Ip" title="Permalink to this headline"></a></h2>
<p>Level 4 HAWC+ additionally provides extensions with the linear polarization percentage (<span class="math notranslate nohighlight">\(p\)</span>), angle (<span class="math notranslate nohighlight">\(\theta\)</span>), and their associated errors (<span class="math notranslate nohighlight">\(\sigma\)</span>).</p>
<p>Percent polarization (<span class="math notranslate nohighlight">\(p\)</span>) and error (<span class="math notranslate nohighlight">\(\sigma_p\)</span>) are calculated as:</p>
<dl class="simple">
<dt>:nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>begin{align}</dt><dd><p>p &amp; = 100sqrt{left(frac{Q}{I}right)^2+left(frac{U}{I}right)^2} \
sigma_p &amp; = frac{100}{I}sqrt{frac{1}{(Q^2+U^2)}left[(Q,sigma_Q)^2+(U,sigma_U)^2+2QU,sigma_{QU}right]+left[left(frac{Q}{I}right)^2+left(frac{U}{I}right)^2right]sigma_I^2-2frac{Q}{I}sigma_{QI}-2frac{U}{I}sigma_{UI}}</p>
</dd>
</dl>
<p>end{align}`</p>
<p>Note that <span class="math notranslate nohighlight">\(p\)</span> here represents the <strong>percent</strong> polarization as opposed to the more typical convention for <span class="math notranslate nohighlight">\(p\)</span> as the <strong>fractional</strong> polarization.</p>
<p>Maps of these data are found in extensions 7 (PERCENT POL) and 9 (ERROR PERCENT POL).</p>
<p>Polarized intensity, <span class="math notranslate nohighlight">\(I_p\)</span>, can then be calculated as <span class="math notranslate nohighlight">\(I_p = \frac{I\times p}{100}\)</span>, which is included in extension 13 (POL FLUX).</p>
<p>Also included is the debiased polarization percentage (<span class="math notranslate nohighlight">\(p^\prime\)</span>) calculated as:</p>
<p><span class="math notranslate nohighlight">\(p^\prime=\sqrt{p^2-\sigma_p^2}\)</span>, found in extension 8 (DEBIASED PERCENT POL).</p>
<p>We similarly define the debiased polarized intensity as <span class="math notranslate nohighlight">\(I_{p^\prime} = \frac{I\times p^\prime}{100}\)</span>, which is included in extension 15 (DEBIASED POL FLUX).</p>
<p>These values are also included in table form in extension 17 (POL DATA).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stokes_ip</span> <span class="o">=</span> <span class="n">hawc</span><span class="p">[</span><span class="s1">&#39;DEBIASED POL FLUX&#39;</span><span class="p">]</span>

<span class="n">axi</span> <span class="o">=</span> <span class="n">FITSFigure</span><span class="p">(</span><span class="n">stokes_i</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">axi</span><span class="o">.</span><span class="n">show_colorscale</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>               <span class="c1"># show I</span>


<span class="n">axp</span> <span class="o">=</span> <span class="n">FITSFigure</span><span class="p">(</span><span class="n">stokes_ip</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">figure</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
<span class="n">axp</span><span class="o">.</span><span class="n">show_colorscale</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>               <span class="c1"># show Ip</span>

<span class="c1"># FORMATTING</span>
<span class="n">axi</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$I$&#39;</span><span class="p">)</span>
<span class="n">axp</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$I_{p^\prime}$&#39;</span><span class="p">)</span>
<span class="n">axp</span><span class="o">.</span><span class="n">axis_labels</span><span class="o">.</span><span class="n">set_yposition</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">axp</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">set_yposition</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">axi</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="n">axi</span><span class="o">.</span><span class="n">axis_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="n">axp</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="n">axp</span><span class="o">.</span><span class="n">axis_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INFO: Auto-setting vmin to -1.021e-01 [aplpy.core]
INFO: Auto-setting vmax to  1.742e+00 [aplpy.core]
INFO: Auto-setting vmin to -9.840e-03 [aplpy.core]
INFO: Auto-setting vmax to  1.092e-01 [aplpy.core]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/HAWC_30Dor_23_1.png" src="_images/HAWC_30Dor_23_1.png" />
</div>
</div>
</section>
<section id="Plotting-Polarization-Vectors">
<h2>Plotting Polarization Vectors<a class="headerlink" href="#Plotting-Polarization-Vectors" title="Permalink to this headline"></a></h2>
<p>From the <span class="math notranslate nohighlight">\(Q\)</span> and <span class="math notranslate nohighlight">\(U\)</span> maps, the polarization angle <span class="math notranslate nohighlight">\(\theta\)</span> is calculated in the standard way:</p>
<p><span class="math notranslate nohighlight">\(\theta = \frac{90}{\pi}\,\mathrm{tan}^{-1}\left(\frac{U}{Q}\right)\)</span></p>
<p>with associated error:</p>
<p><span class="math notranslate nohighlight">\(\sigma_\theta = \frac{90}{\pi\left(Q^2+U^2\right)}\sqrt{\left(Q\sigma_Q\right)^2+\left(U\sigma_U\right)^2-2QU\sigma_{QU}}\)</span></p>
<p>The angle map is stored in extension 10 (POL ANGLE) in degrees, with its error in extension 12 (ERROR POL ANGLE).</p>
<p>As part of the HAWC+ reduction pipeline, <span class="math notranslate nohighlight">\(\theta\)</span> is corrected for the vertical position angle of the instrument on the sky, the angle of the HWP plate, as well as an offset angle that is calibrated to each filter configuration. <span class="math notranslate nohighlight">\(\theta=0^\circ\)</span> corresponds to the North-South direction, <span class="math notranslate nohighlight">\(\theta=90^\circ\)</span> corresponds to the East-West direction, and positive values follow counterclockwise rotation.</p>
<p>We also provide the PA of polarization rotated by <span class="math notranslate nohighlight">\(90^\circ\)</span>, <span class="math notranslate nohighlight">\(\theta_{90}\)</span>, in extension 11 (ROTATED POL ANGLE). This PA of polarization needs to be used with caution. If the measured polarization is dominated by magnetically-aligned dust grains, then the PA of polarization, <span class="math notranslate nohighlight">\(\theta\)</span>, can be rotated by <span class="math notranslate nohighlight">\(90^\circ\)</span> to visualize the magnetic field morphology. For more details, see <a class="reference external" href="http://adsabs.harvard.edu/abs/2000PASP..112.1215H">Hildebrand et al. 2000</a>; <a class="reference external" href="http://adsabs.harvard.edu/abs/2015ARA%26A..53..501A">Andersson et
al. 2015</a>.</p>
<p>We can now use the <span class="math notranslate nohighlight">\(p^\prime\)</span> and <span class="math notranslate nohighlight">\(\theta_{90}\)</span> maps to plot the polarization vectors. First, however, let us make a quality cut. Rather than defining a <span class="math notranslate nohighlight">\(\sigma\)</span> cut on the polarization vectors themselves, it is more useful to define a signal-to-noise cut on total intensity, <span class="math notranslate nohighlight">\(I\)</span>, the measured quantity.</p>
<p>Starting with the propagated error on the polarization fraction:</p>
<dl class="simple">
<dt>:nbsphinx-math:<a href="#id3"><span class="problematic" id="id4">`</span></a>begin{equation*}</dt><dd><p>sigma_p = frac{100}{I}sqrt{frac{1}{(Q^2+U^2)}left[(Q,sigma_Q)^2+(U,sigma_U)^2+2QU,sigma_{QU}right]+left[left(frac{Q}{I}right)^2+left(frac{U}{I}right)^2right]sigma_I^2-2frac{Q}{I}sigma_{QI}-2frac{U}{I}sigma_{UI}}</p>
</dd>
</dl>
<p>end{equation*}`</p>
<p>Let’s assume the errors in <span class="math notranslate nohighlight">\(Q\)</span>, <span class="math notranslate nohighlight">\(U\)</span>, and <span class="math notranslate nohighlight">\(I\)</span> are comparable so that there are no covariant (cross) terms in the error expansion.</p>
<p>Therefore, <span class="math">\begin{equation*}
\sigma_Q = \sigma_U = \sigma_{Q,U} \\
\sigma_{QI} = \sigma_{QU} = \sigma_{UI} = 0
\end{equation*}</span></p>
<p><span class="math notranslate nohighlight">\(\require{cancel}\)</span> <span class="math">\begin{align}
\sigma_p & = \frac{100}{I}\sqrt{\frac{1}{(\cancel{Q^2+U^2})}\left[\sigma_{Q,U}^2\left(\cancel{Q^2+U^2}\right)\right]+
\sigma_I^2\left(\frac{Q^2+U^2}{I^2}\right)} \\
\sigma_p & = \frac{100}{I}\sqrt{\sigma_{Q,U}^2+\sigma_I^2\left(\frac{Q^2+U^2}{I^2}\right)}=
\frac{1}{I}\sqrt{\sigma_{Q,U}^2+\sigma_I^2\,p^2}
\end{align}</span></p>
<p>If we assume that <span class="math notranslate nohighlight">\(p\)</span> is relatively small (e.g. the source is not highly polarized), and that the errors in <span class="math notranslate nohighlight">\(I\)</span> are small, then the second term (<span class="math notranslate nohighlight">\(\sigma_I^2\,p^2\)</span>) is negligible.</p>
<p><span class="math">\begin{equation*}
\sigma_p = \frac{\sigma_{Q,U}}{I}
\end{equation*}</span></p>
<p>By design, the HAWC+ optics split the incident radiation into two orthogonal linear polarization states that are measured with two independent detector arrays. The total intensity, Stokes <span class="math notranslate nohighlight">\(I\)</span>, is recovered by linearly adding both polarization states. If the data is taken at four equally-spaced HWP angles, and assuming 100% efficiency of the instrument, then the uncertainty in <span class="math notranslate nohighlight">\(I\)</span> is related to the uncertanties in <span class="math notranslate nohighlight">\(Q\)</span> and <span class="math notranslate nohighlight">\(U\)</span>: <span class="math">\begin{equation*}
\sigma_Q\sim\sigma_U\sim\sqrt{2}\,\sigma_I
\end{equation*}</span></p>
<p>This simplifies our error on <span class="math notranslate nohighlight">\(p\)</span> to: <span class="math">\begin{align}
\sigma_p &\sim \sqrt{2}\frac{\sigma_I}{I} \\
\sigma_p &\sim \frac{\sqrt{2}}{\left(S/N\right)_I}
\end{align}</span></p>
<p>If we desire an error in <span class="math notranslate nohighlight">\(p\)</span> of <span class="math notranslate nohighlight">\(\sim0.5\%\)</span>, what is the required signal-to-noise in <span class="math notranslate nohighlight">\(I\)</span>?</p>
<dl class="simple">
<dt>:nbsphinx-math:<a href="#id5"><span class="problematic" id="id6">`</span></a>begin{align}</dt><dd><p>left(mathrm{S/N}right)_I &amp; sim sqrt{2}left(frac{1}{sigma_p}right) sim sqrt{2}frac{1}{0.5%} \
&amp; sim frac{sqrt{2}}{0.005} sim 283</p>
</dd>
</dl>
<p>end{align}`</p>
<p>So, therefore if we desire an accuracy of <span class="math notranslate nohighlight">\(\sigma_p\sim0.5\%\)</span>, we require a S/N in total intensity <span class="math notranslate nohighlight">\(I\)</span> of <span class="math notranslate nohighlight">\(\sim283\)</span>.</p>
<p>This S/N cut in <span class="math notranslate nohighlight">\(I\)</span> is very conservative. In the Level 4 HAWC+ data, the last extension, FINAL POL DATA, contains a table of values similar to POL DATA, with somewhat less restrictive quality cuts applied. This extension includes vectors satisfying the following three criteria: 1. (S/N<span class="math notranslate nohighlight">\(_I\)</span>) &gt; 200 2. (S/N<span class="math notranslate nohighlight">\(_p\)</span>) &gt; 3 3. <span class="math notranslate nohighlight">\(p&lt;50\%\)</span></p>
<p>Since we include maps of all measurable polarization information with the full data set, you are free to decide on any quality cuts that satisfy your scientific needs.</p>
<p>In this next panel, we include a single quality cut on S/N &gt; 100, by performing the following steps: 1. use the Stokes <span class="math notranslate nohighlight">\(I\)</span> image as the background for the vector plot 2. perform a quality cut on Stokes <span class="math notranslate nohighlight">\(I/\sigma_I &gt; 100\)</span> to make a mask 3. mask out low S/N vectors 4. plot remaining polarization vectors 5. add contours to better visualize changes in flux across the map</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_polmap</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)):</span>
    <span class="n">hawc</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">hawc</span><span class="p">[</span><span class="s1">&#39;DEBIASED PERCENT POL&#39;</span><span class="p">]</span>    <span class="c1"># %</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">hawc</span><span class="p">[</span><span class="s1">&#39;ROTATED POL ANGLE&#39;</span><span class="p">]</span>   <span class="c1"># deg</span>
    <span class="n">stokes_i</span> <span class="o">=</span> <span class="n">hawc</span><span class="p">[</span><span class="s1">&#39;STOKES I&#39;</span><span class="p">]</span>         <span class="c1"># I</span>
    <span class="n">error_i</span> <span class="o">=</span> <span class="n">hawc</span><span class="p">[</span><span class="s1">&#39;ERROR I&#39;</span><span class="p">]</span>           <span class="c1"># error I</span>

    <span class="c1"># 1. plot Stokes I</span>
    <span class="c1">#  convert from Jy/pix to Jy/sq. arcsec</span>
    <span class="n">pxscale</span> <span class="o">=</span> <span class="n">stokes_i</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CDELT2&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">3600</span>  <span class="c1"># map scale in arcsec/pix.  CDELT2 always in deg</span>
    <span class="n">stokes_i</span><span class="o">.</span><span class="n">data</span> <span class="o">/=</span> <span class="n">pxscale</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">error_i</span><span class="o">.</span><span class="n">data</span> <span class="o">/=</span> <span class="n">pxscale</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">FITSFigure</span><span class="p">(</span><span class="n">stokes_i</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">figure</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="n">subplot</span><span class="p">)</span>

    <span class="c1"># 2. perform S/N cuts on I/sigma_I, and p/sigma_p</span>
    <span class="n">i_err_lim</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">stokes_i</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">error_i</span><span class="o">.</span><span class="n">data</span> <span class="o">&lt;</span> <span class="n">i_err_lim</span><span class="p">)</span>

    <span class="c1"># 3. mask out low S/N vectors by setting masked indices to NaN</span>
    <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># 4. plot vectors</span>
    <span class="n">scalevec</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># 1pix = scalevec * 1% pol          # scale vectors to make it easier to see</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show_vectors</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scalevec</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># step size = display every &#39;step&#39; vectors</span>
                                                        <span class="c1">#   step size of 2 is effectively Nyquist sampling</span>
                                                        <span class="c1">#   --close to the beam size</span>
    <span class="c1"># 5. plot contours</span>
    <span class="n">ncontours</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show_contour</span><span class="p">(</span><span class="n">stokes_i</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">ncontours</span><span class="p">,</span>
                     <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show_contour</span><span class="p">(</span><span class="n">stokes_i</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">ncontours</span><span class="p">,</span>
                     <span class="n">smooth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Show image</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show_colorscale</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="c1"># If title, set it</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># Add colorbar</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">set_axis_label_text</span><span class="p">(</span><span class="s1">&#39;Flux (Jy/arcsec$^2$)&#39;</span><span class="p">)</span>

    <span class="c1"># Add beam indicator</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_beam</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                 <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">corner</span><span class="o">=</span><span class="s1">&#39;bottom left&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;Beam FWHM&#39;</span><span class="p">,</span>
                  <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                  <span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>

    <span class="c1"># Add vector scale</span>
    <span class="c1">#   polarization vectors are displayed such that &#39;scalevec&#39; * 1% pol is 1 pix long</span>
    <span class="c1">#   must translate pixel size to angular degrees since the &#39;add_scalebar&#39; function assumes a physical scale</span>
    <span class="n">vectscale</span> <span class="o">=</span> <span class="n">scalevec</span> <span class="o">*</span> <span class="n">pxscale</span><span class="o">/</span><span class="mi">3600</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_scalebar</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">vectscale</span><span class="p">,</span> <span class="s2">&quot;p = 5%&quot;</span><span class="p">,</span><span class="n">corner</span><span class="o">=</span><span class="s1">&#39;top right&#39;</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># FORMATTING</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">axis_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">stokes_i</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
<p>In step 4 we are arbitrarily setting a scaling factor <em>scalevec</em> to make vectors easier to see in the figure using the FITSFigure <a class="reference external" href="https://aplpy.readthedocs.io/en/stable/api/aplpy.FITSFigure.html#aplpy.FITSFigure.show_vectors">show_vector</a> function.</p>
<p>We are setting <code class="docutils literal notranslate"><span class="pre">show_vector</span></code>’s <em>scale</em> option using our variable <em>scalevec</em>. This should be an integer length, in pixels, of a vector with magnitude 1 in the image specified by the polarization data, <em>p</em>. If <em>p</em> specifies fractional polarization, derive a vector only from every “step” pixels.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stokes_i</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">make_polmap</span><span class="p">(</span><span class="n">afile</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INFO: Auto-setting vmin to -6.756e-02 [aplpy.core]
INFO: Auto-setting vmax to  1.187e+00 [aplpy.core]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/HAWC_30Dor_27_1.png" src="_images/HAWC_30Dor_27_1.png" />
</div>
</div>
</section>
<section id="Plotting-Polarization-Fraction">
<h2>Plotting Polarization Fraction<a class="headerlink" href="#Plotting-Polarization-Fraction" title="Permalink to this headline"></a></h2>
<p>We can also plot the polarization fraction <span class="math notranslate nohighlight">\(p\)</span> to better visualize the structure of 30 Doradus. We plot the same contours from total intensity <span class="math notranslate nohighlight">\(I\)</span> in the background.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">FITSFigure</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># Show image</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show_colorscale</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

<span class="c1"># Plot contours</span>
<span class="n">ncontours</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show_contour</span><span class="p">(</span><span class="n">stokes_i</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">ncontours</span><span class="p">,</span>
                 <span class="n">smooth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Add colorbar</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">set_axis_label_text</span><span class="p">(</span><span class="s1">&#39;$p^\prime$ (%)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INFO: Auto-setting vmin to -1.012e+00 [aplpy.core]
INFO: Auto-setting vmax to  1.123e+01 [aplpy.core]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/HAWC_30Dor_29_1.png" src="_images/HAWC_30Dor_29_1.png" />
</div>
</div>
</section>
<section id="HAWC+-Polarization-Maps">
<h2>HAWC+ Polarization Maps<a class="headerlink" href="#HAWC+-Polarization-Maps" title="Permalink to this headline"></a></h2>
<p>Finally, using the function defined above, we plot all four HAWC+ observations of 30 Doradus.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">afile</span><span class="p">,</span><span class="n">cfile</span><span class="p">,</span><span class="n">dfile</span><span class="p">,</span><span class="n">efile</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">files</span><span class="p">,</span><span class="n">titles</span><span class="p">):</span>
    <span class="n">make_polmap</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">title</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INFO: Auto-setting vmin to -6.528e-02 [aplpy.core]
INFO: Auto-setting vmax to  1.191e+00 [aplpy.core]
INFO: Auto-setting vmin to -8.454e-02 [aplpy.core]
INFO: Auto-setting vmax to  9.216e-01 [aplpy.core]
INFO: Auto-setting vmin to -2.750e-02 [aplpy.core]
INFO: Auto-setting vmax to  3.486e-01 [aplpy.core]
INFO: Auto-setting vmin to -9.768e-03 [aplpy.core]
INFO: Auto-setting vmax to  1.171e-01 [aplpy.core]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/HAWC_30Dor_31_1.png" src="_images/HAWC_30Dor_31_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/HAWC_30Dor_31_2.png" src="_images/HAWC_30Dor_31_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/HAWC_30Dor_31_3.png" src="_images/HAWC_30Dor_31_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/HAWC_30Dor_31_4.png" src="_images/HAWC_30Dor_31_4.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hawc%2B.html" class="btn btn-neutral float-left" title="HAWC+" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="exes.html" class="btn btn-neutral float-right" title="EXES" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, SOFIA/USRA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>